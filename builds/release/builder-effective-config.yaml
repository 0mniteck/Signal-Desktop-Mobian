directories:
  output: release
  buildResources: build
appId: org.whispersystems.signal-desktop
mac:
  artifactName: ${name}-mac-${arch}-${version}.${ext}
  category: public.app-category.social-networking
  darkModeSupport: true
  hardenedRuntime: true
  entitlements: ./build/entitlements.mac.plist
  icon: build/icons/mac/icon.icns
  publish:
    - provider: generic
      url: https://updates.signal.org/desktop
  mergeASARs: true
  releaseInfo:
    vendor:
      minOSVersion: 17.0.0
  singleArchFiles: node_modules/@signalapp/{libsignal-client/prebuilds/**,ringrtc/build/**}
  target:
    - target: zip
      arch:
        - x64
        - arm64
    - target: dmg
      arch:
        - x64
        - arm64
        - universal
  bundleVersion: '1'
win:
  artifactName: ${name}-win-${version}.${ext}
  certificateSubjectName: Signal Messenger, LLC
  certificateSha1: 8C9A0B5C852EC703D83EF7BFBCEB54B796073759
  signingHashAlgorithms:
    - sha256
  publisherName: Signal Messenger, LLC
  icon: build/icons/win/icon.ico
  publish:
    - provider: generic
      url: https://updates.signal.org/desktop
  releaseInfo:
    vendor:
      minOSVersion: 10.0.10240
  signDlls: true
  target:
    - nsis
nsis:
  deleteAppDataOnUninstall: true
  differentialPackage: true
linux:
  category: Network;InstantMessaging;Chat
  desktop:
    StartupWMClass: Signal
  target:
    - deb
  icon: build/icons/png
deb:
  depends:
    - libnotify4
    - libxtst6
    - libnss3
    - libasound2
    - libxss1
    - libc6 (>= 2.31)
protocols:
  name: sgnl-url-scheme
  schemes:
    - sgnl
    - signalcaptcha
afterPack: ts/scripts/after-pack.js
afterSign: ts/scripts/after-sign.js
afterAllArtifactBuild: ts/scripts/after-all-artifact-build.js
asar:
  smartUnpack: false
asarUnpack:
  - '**/*.node'
files:
  - filter:
      - package.json
      - config/default.json
      - config/${env.SIGNAL_ENV}.json
      - config/local-${env.SIGNAL_ENV}.json
      - bundles/**
      - background.html
      - about.html
      - screenShare.html
      - settings.html
      - permissions_popup.html
      - debug_log.html
      - loading.html
      - _locales/**
      - js/**
      - libtextsecure/**
      - ts/**/*.js
      - ts/*.js
      - '!build'
      - '!ts/{storybook,test-node,test-mock,test-both,test-electron}'
      - '!**/{tsconfig,bower,component}.json'
      - '!**/.{github,husky,grenrc,npmrc,nycrc,taprc,bithoundrc}'
      - '!**/.testem.json'
      - '!**/.babelrc*'
      - '!**/.eslintrc*'
      - '!**/.prettier*'
      - '!**/.jscs*'
      - '!**/*travis*.yml'
      - '!**/{CHANGES,TODO,CHANGES.md~,README.md~}'
      - '!**/*.stories.js'
      - '!**/*.jest.js'
      - '!**/*.{bak,bnf,flow,patch,markdown,bnf,mli,ts,map}'
      - '!node_modules/intl-tel-input/composer.json'
      - '!js/register.js'
      - stylesheets/*.css
      - app/*
      - preload.bundle.js
      - preload_utils.js
      - main.js
      - images/**
      - fonts/**
      - sounds/*
      - build/icons
      - build/available-locales.json
      - node_modules/**
      - '!node_modules/underscore/**'
      - '!node_modules/emoji-datasource/emoji_pretty.json'
      - '!node_modules/emoji-datasource/**/*.png'
      - '!node_modules/emoji-datasource-apple/emoji_pretty.json'
      - '!node_modules/emoji-datasource-apple/img/apple/sheets*'
      - '!node_modules/spellchecker/vendor/hunspell/**/*'
      - '!**/node_modules/*/{CHANGELOG.md,README.md,README,readme.md,readme,test,__tests__,tests,powered-test,example,examples,*.d.ts,.snyk-*.flag,benchmark}'
      - '!**/node_modules/.bin'
      - '!**/node_modules/**/build/**'
      - node_modules/intl-tel-input/build/**
      - '!**/node_modules/**/prebuilds/**'
      - '!**/*.{o,hprof,orig,pyc,pyo,rbc,c,h,m}'
      - '!**/._*'
      - '!**/{.DS_Store,.git,.hg,.svn,CVS,RCS,SCCS,__pycache__,thumbs.db,.gitignore,.gitattributes,.flowconfig,.yarn-metadata.json,.idea,appveyor.yml,.travis.yml,circle.yml,npm-debug.log,.nyc_output,yarn.lock,.yarn-integrity}'
      - node_modules/spellchecker/build/Release/*.node
      - node_modules/websocket/build/Release/*.node
      - '!node_modules/websocket/builderror.log'
      - node_modules/socks/build/*.js
      - node_modules/socks/build/common/*.js
      - node_modules/socks/build/client/*.js
      - node_modules/smart-buffer/build/*.js
      - '!node_modules/@signalapp/better-sqlite3/deps/*'
      - '!node_modules/@signalapp/better-sqlite3/src/*'
      - node_modules/@signalapp/better-sqlite3/build/Release/better_sqlite3.node
      - node_modules/@signalapp/libsignal-client/prebuilds/${platform}-${arch}/*.node
      - '!node_modules/@signalapp/ringrtc/scripts/*'
      - node_modules/@signalapp/ringrtc/build/${platform}/*${arch}*.node
      - node_modules/mac-screen-capture-permissions/build/Release/*.node
      - node_modules/fs-xattr/build/Release/*.node
      - '!**/node_modules/react-dom/*/*.development.js'
      - '!node_modules/mp4box/**'
      - node_modules/mp4box/package.json
      - node_modules/mp4box/dist/mp4box.all.js
      - '!node_modules/.cache'
      - sticker-creator/dist/**
extraMetadata:
  environment: production
electronVersion: 24.3.0
